// .config/Code/User/tasks.json
{
	"version": "2.0.0",
	"tasks": [
		{
			"type": "cargo",
			"command": "build",
			"problemMatcher": [
				"$rustc"
			],
			"group": {
                "kind": "build",
                "isDefault": true
            },
			"label": "rust: cargo build"
		},
		{
			"type": "cargo",
			"command": "build",
			"problemMatcher": [
				"$rustc"
			],
			"args": [
                "--features",
                "${input:features}",
				"--target",
				"${input:target}",
				"${input:mode}"
            ],
			"group": {
                "kind": "build",
                "isDefault": false
            },
			"label": "rust: cargo build (Args)"
		},
		{
			"type": "cargo",
			"command": "test",
			"problemMatcher": [
				"$rustc"
			],
			"group": {
                "kind": "test",
                "isDefault": false
            },
			"label": "rust: cargo test"
		},
		{
			"type": "cargo",
			"command": "espflash",
			"problemMatcher": [
				"$rustc"
			],
			"args": [
				"--target",
				"${input:target}",
				"${input:mode}",
				"${input:monitor}"
            ],
			"group": {
                "kind": "test",
                "isDefault": true
            },
			"label": "rust: cargo espflash"
		}
	],
	"inputs": [
        {
            "id": "features",
            "type": "pickString",
            "description": "Choose build method:",
            "options": [
                "native",
                "pio"
            ],
            "default": "native"
        },
        {
            "id": "target",
            "type": "pickString",
            "description": "Choose target:",
            "options": [
                "riscv32imc-esp-espidf",
                "xtensa-esp32s2-espidf",
				"xtensa-esp32-espidf"
            ],
            "default": "riscv32imc-esp-espidf"
        }
		,
        {
            "id": "mode",
            "type": "pickString",
            "description": "Release?",
            "options": [
                "",
                "--release",
            ],
            "default": ""
        }
		,
        {
            "id": "monitor",
            "type": "pickString",
            "description": "Monitor?",
            "options": [
                "",
                "--monitor",
            ],
            "default": ""
        },
		{
			"type": "promptString",
			"id": "serialPort",
			"description": "Serial Port:",
			"default": "/dev/ttyUSB0"
		}
    ]
}